document.addEventListener("DOMContentLoaded",()=>{function e(e){try{e()}catch(t){console.error(`Error in ${e.name}:`,t)}}function t(){if(window.matchMedia("(hover: none)").matches)return;let e=document.querySelector(".cursor");if(!e)return;document.addEventListener("mousemove",t=>{e.classList.contains("visible")||e.classList.add("visible"),e.style.left=t.clientX+"px",e.style.top=t.clientY+"px"}),document.addEventListener("mouseleave",()=>e.classList.remove("visible")),document.addEventListener("mouseenter",()=>e.classList.add("visible")),document.addEventListener("mousedown",()=>document.body.classList.add("click-active")),document.addEventListener("mouseup",()=>document.body.classList.remove("click-active"));let t=`
            a:not(.cta):not(.ctaProjects),
            button:not(#back-to-top):not(#terminal-toggle),
            .nav-link
        `,s=document.querySelectorAll(t);s.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("hover-active")),e.addEventListener("mouseleave",()=>document.body.classList.remove("hover-active"))});let l=document.querySelectorAll(".cta, .ctaProjects");l.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("cta-hover-active")),e.addEventListener("mouseleave",()=>document.body.classList.remove("cta-hover-active"))});let n=`
            #back-to-top,
            #terminal-toggle,
            .timeline-icon,
            .skills-list span
        `,i=document.querySelectorAll(n);i.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("contrast-active")),e.addEventListener("mouseleave",()=>document.body.classList.remove("contrast-active"))});let r=document.querySelectorAll("img");r.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("image-hover")),e.addEventListener("mouseleave",()=>document.body.classList.remove("image-hover"))})}function s(){let e=document.querySelector(".multiple-text");if(!e)return;let t=["Implementation Specialist","Unity Developer","Software Engineer","Cybersecurity Student",],s=new class e{constructor(e){this.el=e,this.chars="!<>-_\\/[]{}—=+*^?#________",this.update=this.update.bind(this)}setText(e){let t=this.el.innerText,s=Math.max(t.length,e.length),l=new Promise(e=>this.resolve=e);this.queue=[];for(let n=0;n<s;n++){let i=t[n]||"",r=e[n]||"",o=Math.floor(40*Math.random()),a=o+Math.floor(40*Math.random());this.queue.push({from:i,to:r,start:o,end:a})}return cancelAnimationFrame(this.frameRequest),this.frame=0,this.update(),l}update(){let e="",t=0;for(let s=0,l=this.queue.length;s<l;s++){let{from:n,to:i,start:r,end:o,char:a}=this.queue[s];this.frame>=o?(t++,e+=i):this.frame>=r?((!a||.28>Math.random())&&(a=this.randomChar(),this.queue[s].char=a),e+=`<span class="dud">${a}</span>`):e+=n}this.el.innerHTML=e,t===this.queue.length?this.resolve():(this.frameRequest=requestAnimationFrame(this.update),this.frame++)}randomChar(){return this.chars[Math.floor(Math.random()*this.chars.length)]}}(e),l=0,n=()=>{s.setText(t[l]).then(()=>{setTimeout(n,2500)}),l=(l+1)%t.length};n()}function l(){let e=document.querySelectorAll(".btn-hover");function t(e,t,s=!1){let l="0%",n="0%";0===t?n="-100%":1===t?l="100%":2===t?n="100%":l="-100%",e.style.setProperty("--tx",l),e.style.setProperty("--ty",n)}function s(e,t){let s=t.offsetWidth,l=t.offsetHeight,n=t.getBoundingClientRect(),i=(e.clientX-n.left-s/2)*(s>l?l/s:1),r=(e.clientY-n.top-l/2)*(l>s?s/l:1);return Math.round((Math.atan2(r,i)*(180/Math.PI)+180)/90+3)%4}e.forEach(e=>{e.addEventListener("mouseenter",function(l){let n=s(l,e);e.style.setProperty("--transition","none"),t(e,n),e.offsetHeight,e.style.setProperty("--transition","transform 0.3s cubic-bezier(0.215, 0.610, 0.355, 1.000)"),e.style.setProperty("--tx","0%"),e.style.setProperty("--ty","0%")}),e.addEventListener("mouseleave",function(l){let n=s(l,e);e.style.setProperty("--transition","transform 0.3s cubic-bezier(0.215, 0.610, 0.355, 1.000)"),t(e,n,!0)})})}function n(){let e=document.getElementById("theme-toggle");if(!e)return;let t=e.querySelector("i"),s=localStorage.getItem("theme"),l=window.matchMedia("(prefers-color-scheme: light)").matches;function n(e){t&&(e?(t.classList.remove("fa-sun-o"),t.classList.add("fa-moon-o")):(t.classList.remove("fa-moon-o"),t.classList.add("fa-sun-o")))}("light"===s||!s&&l)&&(document.body.classList.add("light-mode"),n(!0)),e.addEventListener("click",()=>{this.blur(),document.body.classList.toggle("light-mode");let e=document.body.classList.contains("light-mode");localStorage.setItem("theme",e?"light":"dark"),n(e)}),window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",e=>{localStorage.getItem("theme")||(e.matches?(document.body.classList.add("light-mode"),n(!0)):(document.body.classList.remove("light-mode"),n(!1)))})}function i(){let e=document.querySelector(".year");e&&(e.textContent=new Date().getFullYear())}function r(){let e=document.querySelector(".hamburger"),t=document.querySelector(".nav-list ul"),s=document.querySelectorAll(".nav-list ul li a");e&&t&&(e.addEventListener("click",()=>{e.classList.toggle("active"),t.classList.toggle("active"),document.body.classList.toggle("no-scroll")}),s.forEach(s=>{s.addEventListener("click",()=>{e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("no-scroll")})}))}function o(){let e=document.querySelector(".marker"),t=document.querySelectorAll(".nav-link"),s=document.querySelectorAll("section"),l=document.querySelector(".header.container"),n=document.querySelector(".hamburger"),i=document.querySelector(".nav-list ul"),r=!1,o;function a(t){t&&e&&(e.style.left=t.offsetLeft+"px",e.style.width=t.offsetWidth+"px")}let c=document.querySelector('a[data-section="home"]');c&&a(c),t.forEach(e=>{e.addEventListener("click",()=>{r=!0,t.forEach(e=>e.classList.remove("active-link")),e.classList.add("active-link"),a(e),n&&n.classList.remove("active"),i&&i.classList.remove("active"),document.body.classList.remove("no-scroll"),clearTimeout(o),o=setTimeout(()=>{r=!1},1500)})});let d=!1;window.addEventListener("scroll",()=>{d||(window.requestAnimationFrame(()=>{if(l&&(l.style.backgroundColor=(window.scrollY,"var(--header-bg)")),!r){let e="";s.forEach(t=>{window.pageYOffset>=t.offsetTop-200&&(e=t.getAttribute("id"))}),t.forEach(t=>{t.classList.remove("active-link"),t.dataset.section===e&&(t.classList.add("active-link"),a(t))}),window.scrollY<100&&c&&a(c)}d=!1}),d=!0)},{passive:!0})}function a(){let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?e.target.classList.add("show"):e.target.classList.remove("show")})},{threshold:.15});document.querySelectorAll(".hidden").forEach(t=>e.observe(t))}function c(){let e=document.querySelector("#stats"),t=document.querySelectorAll(".counter"),s=!1,l=new IntersectionObserver(e=>{e[0].isIntersecting&&!s&&(s=!0,t.forEach(e=>{let t=+e.getAttribute("data-target"),s=t/125,l=0,n=()=>{(l+=s)<t?(e.textContent=Math.ceil(l),requestAnimationFrame(n)):e.textContent=t+(t>100?"+":"")};n()}))},{threshold:.25});e&&l.observe(e)}function d(){let e=document.querySelector("#timeline"),t=document.querySelector(".timeline-line-fill"),s=!1;e&&t&&window.addEventListener("scroll",()=>{s||(window.requestAnimationFrame(()=>{let l=e.getBoundingClientRect(),n=window.innerHeight/2,i=-l.top+n,r=i/e.offsetHeight*100;r=Math.max(0,Math.min(100,r)),t.style.height=`${r}%`,s=!1}),s=!0)},{passive:!0})}function h(){let e=document.getElementById("back-to-top");e&&(window.addEventListener("scroll",()=>{window.scrollY>500?e.classList.add("visible"):e.classList.remove("visible")},{passive:!0}),e.addEventListener("click",()=>{this.blur(),window.scrollTo({top:0,behavior:"smooth"})}))}function m(){let e=document.querySelectorAll(".copy-email"),t=!1;function s(e){let s=document.createElement("div");s.className="toast-notification",s.innerHTML=`<i class="fa fa-check-circle"></i> <span>${e}</span>`,document.body.appendChild(s),s.offsetHeight,s.classList.add("show"),setTimeout(()=>{s.classList.remove("show"),setTimeout(()=>{document.body.contains(s)&&document.body.removeChild(s),t=!1},400)},3e3)}e.forEach(e=>{e.addEventListener("click",l=>{if(l.preventDefault(),l.currentTarget.blur(),t)return;t=!0;let n=e.getAttribute("data-email");navigator.clipboard.writeText(n).then(()=>{let t=e.querySelector("i"),l=t.className;t.className="fa fa-check",e.style.color="var(--accent)",setTimeout(()=>{t.className=l,e.style.color=""},2e3),s("Email copied to clipboard!")}).catch(e=>{console.error("Failed to copy:",e),s("Failed to copy email.")})})})}function u(){let e=document.getElementById("terminal-toggle"),t=document.getElementById("close-terminal"),s=document.getElementById("terminal-overlay"),l=document.getElementById("terminal-header"),n=document.getElementById("terminal-input"),i=document.getElementById("terminal-body");if(!e||!s||!n)return;let r=!0,o=[],a=-1,c={"about.txt":"Junior Technical Implementation Specialist & Cybersecurity student. Passionate about C#, .NET, and breaking things to fix them.","skills.md":"C# | .NET | Unity | Python | SQL | Git | Cybersecurity","contact.info":"Email: paweltrojanski@gmail.com | LinkedIn: /in/ptrojanski","projects/":"Dir: [NetSentry, WeatherProphet, OperationDeratization, VibrantIcons]","cv.pdf":"Binary file. Use command 'open cv.pdf' to view."};e.addEventListener("click",e=>{if(e.preventDefault(),s.classList.contains("hidden-terminal")){if(s.classList.remove("hidden-terminal"),r){let t=window.innerWidth,l=window.innerHeight,i=s.offsetWidth,o=s.offsetHeight;s.style.transform="none",s.style.left=`${(t-i)/2}px`,s.style.top=`${(l-o)/2}px`,r=!1}n.focus()}else s.classList.add("hidden-terminal")}),t.addEventListener("click",()=>{s.classList.add("hidden-terminal")}),i.addEventListener("click",()=>{0===window.getSelection().toString().length&&n.focus()});let d=!1,h,m,u,f;function p(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}l.addEventListener("mousedown",e=>{d=!0,h=e.clientX,m=e.clientY;let t=s.getBoundingClientRect();u=t.left,f=t.top,s.style.transform="none",s.style.left=u+"px",s.style.top=f+"px",document.body.style.userSelect="none"}),document.addEventListener("mousemove",e=>{if(!d)return;let t=e.clientX-h,l=e.clientY-m,n=u+t,i=f+l,r=window.innerWidth,o=window.innerHeight,a=s.offsetWidth,c=s.offsetHeight;n<0&&(n=0),n+a>r&&(n=r-a),i<0&&(i=0),i+c>o&&(i=o-c),s.style.left=`${n}px`,s.style.top=`${i}px`}),document.addEventListener("mouseup",()=>{d=!1,document.body.style.userSelect=""}),n.addEventListener("keydown",function(e){if("Enter"===e.key){let t=this.value.trim();""!==t&&(o.push(t),a=o.length);let l=t.split(/\s+/),n=l[0].toLowerCase();(function e(t,l,n){let r=document.createElement("div");r.innerHTML=`<span class="prompt-text" style="color:#aaa;">[guest@ptrojanski ~]$</span> ${p(n)}`,i.insertBefore(r,i.lastElementChild);let o="",a=!1;switch(t){case"help":o=`Available commands:
            <br>&nbsp;&nbsp;<span style="color:#fff">ls</span>       - List directory contents
            <br>&nbsp;&nbsp;<span style="color:#fff">cat [file]</span> - Display file content
            <br>&nbsp;&nbsp;<span style="color:#fff">cd [dir]</span>  - Change directory (navigation)
            <br>&nbsp;&nbsp;<span style="color:#fff">whoami</span>    - Display current user
            <br>&nbsp;&nbsp;<span style="color:#fff">date</span>      - Display current date/time
            <br>&nbsp;&nbsp;<span style="color:#fff">theme</span>     - Switch theme (usage: theme light/dark)
            <br>&nbsp;&nbsp;<span style="color:#fff">clear</span>     - Clear terminal screen
            <br>&nbsp;&nbsp;<span style="color:#fff">exit</span>      - Close terminal`,a=!0;break;case"ls":case"ll":let d=Object.keys(c).map(e=>e.endsWith("/")?`<span style="color:#4d4dff; font-weight:bold;">${e}</span>`:e.endsWith(".pdf")||e.endsWith(".zip")?`<span style="color:#ff5f56;">${e}</span>`:`<span style="color:#ccc;">${e}</span>`).join("&nbsp;&nbsp;&nbsp;");o=d,a=!0;break;case"cat":if(0===l.length)o="usage: cat [file]";else{let h=l[0];o=c[h]?c[h]:`cat: ${p(h)}: No such file or directory`}break;case"whoami":o="root (Paweł Trojański)";break;case"date":o=new Date().toString();break;case"cd":case"open":if(0===l.length)o="usage: cd [directory] or open [file]";else{let m=l[0].toLowerCase();"projects"===m||"projects/"===m?(o="Navigating to Projects section...",document.querySelector("#projects").scrollIntoView({behavior:"smooth"}),window.innerWidth<768&&s.classList.add("hidden-terminal")):"cv.pdf"===m?(o="Opening CV...",window.open("./assets/files/cv.pdf","_blank")):o=`cd: ${p(m)}: No such directory (Try 'projects')`}break;case"theme":if(0===l.length)o="usage: theme [light|dark]";else{let u=l[0].toLowerCase(),f=document.getElementById("theme-toggle");"light"===u?(document.body.classList.contains("light-mode")||f.click(),o="Theme set to LIGHT."):"dark"===u?(document.body.classList.contains("light-mode")&&f.click(),o="Theme set to DARK."):o=`theme: unknown argument '${p(u)}'`}break;case"sudo":o='<span style="color:red">guest is not in the sudoers file. This incident will be reported.</span>',a=!0;break;case"exit":s.classList.add("hidden-terminal");return;case"clear":for(;i.children.length>1;)i.removeChild(i.firstChild);return;case"":return;default:o=`Command not found: ${p(t)}. Type 'help' for options.`}let y=document.createElement("div");y.style.marginBottom="10px",y.style.color="#ccc",a?y.innerHTML=o:y.textContent=o,i.insertBefore(y,i.lastElementChild),i.scrollTop=i.scrollHeight})(n,l.slice(1),t),this.value=""}else"ArrowUp"===e.key?(e.preventDefault(),a>0&&(a--,this.value=o[a])):"ArrowDown"===e.key&&(e.preventDefault(),a<o.length-1?(a++,this.value=o[a]):(a=o.length,this.value=""))})}e(n),e(s),e(i),e(r),e(o),e(t),e(l),e(a),e(c),e(d),e(h),e(m),e(u)});
document.addEventListener("DOMContentLoaded",()=>{function e(e){try{e()}catch(t){console.error(`Error in ${e.name}:`,t)}}function t(){if(window.matchMedia("(hover: none)").matches)return;let e=document.querySelector(".cursor");if(!e)return;document.addEventListener("mousemove",t=>{e.classList.contains("visible")||e.classList.add("visible"),e.style.left=t.clientX+"px",e.style.top=t.clientY+"px"}),document.addEventListener("mouseleave",()=>e.classList.remove("visible")),document.addEventListener("mouseenter",()=>e.classList.add("visible")),document.addEventListener("mousedown",()=>document.body.classList.add("click-active")),document.addEventListener("mouseup",()=>document.body.classList.remove("click-active"));let t=`
            a:not(.cta):not(.ctaProjects),
            button:not(#back-to-top):not(#terminal-toggle),
            .nav-link
        `,s=document.querySelectorAll(t);s.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("hover-active")),e.addEventListener("mouseleave",()=>document.body.classList.remove("hover-active"))});let n=document.querySelectorAll(".cta, .ctaProjects");n.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("cta-hover-active")),e.addEventListener("mouseleave",()=>document.body.classList.remove("cta-hover-active"))});let i=`
            #back-to-top,
            #terminal-toggle,
            .timeline-icon,
            .skills-list span
        `,l=document.querySelectorAll(i);l.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("contrast-active")),e.addEventListener("mouseleave",()=>document.body.classList.remove("contrast-active"))});let r=document.querySelectorAll("img");r.forEach(e=>{e.addEventListener("mouseenter",()=>document.body.classList.add("image-hover")),e.addEventListener("mouseleave",()=>document.body.classList.remove("image-hover"))})}function s(){let e=document.querySelector(".multiple-text");if(!e)return;let t=["Implementation Specialist","Unity Developer","Software Engineer","Cybersecurity Student",],s=new class e{constructor(e){this.el=e,this.chars="!<>-_\\/[]{}—=+*^?#________",this.update=this.update.bind(this)}setText(e){let t=this.el.innerText,s=Math.max(t.length,e.length),n=new Promise(e=>this.resolve=e);this.queue=[];for(let i=0;i<s;i++){let l=t[i]||"",r=e[i]||"",o=Math.floor(40*Math.random()),a=o+Math.floor(40*Math.random());this.queue.push({from:l,to:r,start:o,end:a})}return cancelAnimationFrame(this.frameRequest),this.frame=0,this.update(),n}update(){let e="",t=0;for(let s=0,n=this.queue.length;s<n;s++){let{from:i,to:l,start:r,end:o,char:a}=this.queue[s];this.frame>=o?(t++,e+=l):this.frame>=r?((!a||.28>Math.random())&&(a=this.randomChar(),this.queue[s].char=a),e+=`<span class="dud">${a}</span>`):e+=i}this.el.innerHTML=e,t===this.queue.length?this.resolve():(this.frameRequest=requestAnimationFrame(this.update),this.frame++)}randomChar(){return this.chars[Math.floor(Math.random()*this.chars.length)]}}(e),n=0,i=()=>{s.setText(t[n]).then(()=>{setTimeout(i,2500)}),n=(n+1)%t.length};i()}function n(){let e=document.querySelectorAll(".btn-hover");function t(e,t,s=!1){let n="0%",i="0%";0===t?i="-100%":1===t?n="100%":2===t?i="100%":n="-100%",e.style.setProperty("--tx",n),e.style.setProperty("--ty",i)}function s(e,t){let s=t.offsetWidth,n=t.offsetHeight,i=t.getBoundingClientRect(),l=(e.clientX-i.left-s/2)*(s>n?n/s:1),r=(e.clientY-i.top-n/2)*(n>s?s/n:1);return Math.round((Math.atan2(r,l)*(180/Math.PI)+180)/90+3)%4}e.forEach(e=>{e.addEventListener("mouseenter",function(n){let i=s(n,e);e.style.setProperty("--transition","none"),t(e,i),e.offsetHeight,e.style.setProperty("--transition","transform 0.3s cubic-bezier(0.215, 0.610, 0.355, 1.000)"),e.style.setProperty("--tx","0%"),e.style.setProperty("--ty","0%")}),e.addEventListener("mouseleave",function(n){let i=s(n,e);e.style.setProperty("--transition","transform 0.3s cubic-bezier(0.215, 0.610, 0.355, 1.000)"),t(e,i,!0)})})}function i(){let e=document.getElementById("theme-toggle");if(!e)return;let t=e.querySelector("i"),s=localStorage.getItem("theme"),n=window.matchMedia("(prefers-color-scheme: light)").matches;function i(e){t&&(e?(t.classList.remove("fa-sun-o"),t.classList.add("fa-moon-o")):(t.classList.remove("fa-moon-o"),t.classList.add("fa-sun-o")))}("light"===s||!s&&n)&&(document.body.classList.add("light-mode"),i(!0)),e.addEventListener("click",()=>{this.blur(),document.body.classList.toggle("light-mode");let e=document.body.classList.contains("light-mode");localStorage.setItem("theme",e?"light":"dark"),i(e)}),window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",e=>{localStorage.getItem("theme")||(e.matches?(document.body.classList.add("light-mode"),i(!0)):(document.body.classList.remove("light-mode"),i(!1)))})}function l(){let e=document.querySelector(".year");e&&(e.textContent=new Date().getFullYear())}function r(){let e=document.querySelector(".hamburger"),t=document.querySelector(".nav-list ul"),s=document.querySelectorAll(".nav-list ul li a");e&&t&&(e.addEventListener("click",()=>{e.classList.toggle("active"),t.classList.toggle("active"),document.body.classList.toggle("no-scroll")}),s.forEach(s=>{s.addEventListener("click",()=>{e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("no-scroll")})}))}function o(){let e=document.querySelector(".marker"),t=document.querySelectorAll(".nav-link"),s=document.querySelectorAll("section"),n=document.querySelector(".header.container"),i=document.querySelector(".hamburger"),l=document.querySelector(".nav-list ul"),r=!1,o;function a(t){t&&e&&(e.style.left=t.offsetLeft+"px",e.style.width=t.offsetWidth+"px")}let c=document.querySelector('a[data-section="home"]');c&&a(c),t.forEach(e=>{e.addEventListener("click",()=>{r=!0,t.forEach(e=>e.classList.remove("active-link")),e.classList.add("active-link"),a(e),i&&i.classList.remove("active"),l&&l.classList.remove("active"),document.body.classList.remove("no-scroll"),clearTimeout(o),o=setTimeout(()=>{r=!1},1500)})});let d=!1;window.addEventListener("scroll",()=>{d||(window.requestAnimationFrame(()=>{if(n&&(n.style.backgroundColor=(window.scrollY,"var(--header-bg)")),!r){let e="";s.forEach(t=>{window.pageYOffset>=t.offsetTop-200&&(e=t.getAttribute("id"))}),t.forEach(t=>{t.classList.remove("active-link"),t.dataset.section===e&&(t.classList.add("active-link"),a(t))}),window.scrollY<100&&c&&a(c)}d=!1}),d=!0)},{passive:!0})}function a(){let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?e.target.classList.add("show"):e.target.classList.remove("show")})},{threshold:.15});document.querySelectorAll(".hidden").forEach(t=>e.observe(t))}function c(){let e=document.querySelector("#stats"),t=document.querySelectorAll(".counter"),s=!1,n=new IntersectionObserver(e=>{e[0].isIntersecting&&!s&&(s=!0,t.forEach(e=>{let t=+e.getAttribute("data-target"),s=t/125,n=0,i=()=>{(n+=s)<t?(e.textContent=Math.ceil(n),requestAnimationFrame(i)):e.textContent=t+(t>100?"+":"")};i()}))},{threshold:.25});e&&n.observe(e)}function d(){let e=document.querySelector("#timeline"),t=document.querySelector(".timeline-line-fill"),s=!1;e&&t&&window.addEventListener("scroll",()=>{s||(window.requestAnimationFrame(()=>{let n=e.getBoundingClientRect(),i=window.innerHeight/2,l=-n.top+i,r=l/e.offsetHeight*100;r=Math.max(0,Math.min(100,r)),t.style.height=`${r}%`,s=!1}),s=!0)},{passive:!0})}function h(){let e=document.getElementById("back-to-top");e&&(window.addEventListener("scroll",()=>{window.scrollY>500?e.classList.add("visible"):e.classList.remove("visible")},{passive:!0}),e.addEventListener("click",()=>{this.blur(),window.scrollTo({top:0,behavior:"smooth"})}))}function m(){let e=document.querySelectorAll(".copy-email"),t=!1;function s(e){let s=document.createElement("div");s.className="toast-notification",s.innerHTML=`<i class="fa fa-check-circle"></i> <span>${e}</span>`,document.body.appendChild(s),s.offsetHeight,s.classList.add("show"),setTimeout(()=>{s.classList.remove("show"),setTimeout(()=>{document.body.contains(s)&&document.body.removeChild(s),t=!1},400)},3e3)}e.forEach(e=>{e.addEventListener("click",n=>{if(n.preventDefault(),n.currentTarget.blur(),t)return;t=!0;let i=e.getAttribute("data-email");navigator.clipboard.writeText(i).then(()=>{let t=e.querySelector("i"),n=t.className;t.className="fa fa-check",e.style.color="var(--accent)",setTimeout(()=>{t.className=n,e.style.color=""},2e3),s("Email copied to clipboard!")}).catch(e=>{console.error("Failed to copy:",e),s("Failed to copy email.")})})})}function f(){let e=document.getElementById("terminal-toggle"),t=document.getElementById("close-terminal"),s=document.getElementById("terminal-overlay"),n=document.getElementById("terminal-header"),i=document.getElementById("terminal-input"),l=document.getElementById("terminal-body");if(!e||!s||!i)return;let r=!0,o=[],a=-1,c={"about.txt":"Junior Technical Implementation Specialist & Cybersecurity student. Passionate about C#, .NET, and breaking things to fix them.","skills.md":"C# | .NET | Unity | Python | SQL | Frontend | Git | Cybersecurity","contact.info":"Email: paweltrojanski@gmail.com | LinkedIn: /in/ptrojanski","projects/":"Dir: [NetSentry, App Store Reviews Extractor, Vibrant Icons, Operation Deratization, Pomodoro Timer, WeatherProphet]","cv.pdf":"Binary file. Use command 'open cv.pdf' to view."};e.addEventListener("click",e=>{if(e.preventDefault(),s.classList.contains("hidden-terminal")){if(s.classList.remove("hidden-terminal"),r){let t=window.innerWidth,n=window.innerHeight,l=s.offsetWidth,o=s.offsetHeight;s.style.transform="none",s.style.left=`${(t-l)/2}px`,s.style.top=`${(n-o)/2}px`,r=!1}i.focus()}else s.classList.add("hidden-terminal")}),t.addEventListener("click",()=>{s.classList.add("hidden-terminal")}),l.addEventListener("click",()=>{0===window.getSelection().toString().length&&i.focus()});let d=!1,h,m,f,u;function p(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}n.addEventListener("mousedown",e=>{d=!0,h=e.clientX,m=e.clientY;let t=s.getBoundingClientRect();f=t.left,u=t.top,s.style.transform="none",s.style.left=f+"px",s.style.top=u+"px",document.body.style.userSelect="none"}),document.addEventListener("mousemove",e=>{if(!d)return;let t=e.clientX-h,n=e.clientY-m,i=f+t,l=u+n,r=window.innerWidth,o=window.innerHeight,a=s.offsetWidth,c=s.offsetHeight;i<0&&(i=0),i+a>r&&(i=r-a),l<0&&(l=0),l+c>o&&(l=o-c),s.style.left=`${i}px`,s.style.top=`${l}px`}),document.addEventListener("mouseup",()=>{d=!1,document.body.style.userSelect=""}),i.addEventListener("keydown",function(e){if("Enter"===e.key){let t=this.value.trim();""!==t&&(o.push(t),a=o.length);let n=t.split(/\s+/),i=n[0].toLowerCase();(function e(t,n,i){let r=document.createElement("div");r.innerHTML=`<span class="prompt-text" style="color:#aaa;">[guest@ptrojanski ~]$</span> ${p(i)}`,l.insertBefore(r,l.lastElementChild);let o="",a=!1;switch(t){case"help":o=`Available commands:
            <br>&nbsp;&nbsp;<span style="color:#fff">ls</span>       - List directory contents
            <br>&nbsp;&nbsp;<span style="color:#fff">cat [file]</span> - Display file content
            <br>&nbsp;&nbsp;<span style="color:#fff">cd [dir]</span>  - Change directory
            <br>&nbsp;&nbsp;<span style="color:#fff">whoami</span>    - Display current user
            <br>&nbsp;&nbsp;<span style="color:#fff">matrix</span>    - Enter the Matrix
            <br>&nbsp;&nbsp;<span style="color:#fff">reboot</span>    - Restart system
            <br>&nbsp;&nbsp;<span style="color:#fff">theme</span>     - Switch theme [light/dark]
            <br>&nbsp;&nbsp;<span style="color:#fff">clear</span>     - Clear terminal
            <br>&nbsp;&nbsp;<span style="color:#fff">exit</span>      - Close terminal`,a=!0;break;case"ls":case"ll":let d=Object.keys(c).map(e=>e.endsWith("/")?`<span style="color:#4d4dff; font-weight:bold;">${e}</span>`:e.endsWith(".pdf")||e.endsWith(".zip")?`<span style="color:#ff5f56;">${e}</span>`:`<span style="color:#ccc;">${e}</span>`).join("&nbsp;&nbsp;&nbsp;");o=d,a=!0;break;case"cat":o=0===n.length?"usage: cat [file]":c[n[0]]?c[n[0]]:`cat: ${p(n[0])}: No such file or directory`;break;case"whoami":o=`<pre style="font-size: 0.5rem; line-height: 1; color: var(--accent); margin-bottom: 10px; margin-top: 5px;">
          ██████╗  █████╗ ██╗    ██╗███████╗██╗
          ██╔══██╗██╔══██╗██║    ██║██╔════╝██║
          ██████╔╝███████║██║ █╗ ██║█████╗  ██║
          ██╔═══╝ ██╔══██║██║███╗██║██╔══╝  ██║
          ██║     ██║  ██║╚███╔███╔╝███████╗███████╗
          ╚═╝     ╚═╝  ╚═╝ ╚══╝╚══╝ ╚══════╝╚══════╝

          ████████╗██████╗  ██████╗      ██╗ █████╗ ███╗   ██╗███████╗██╗  ██╗██╗
          ╚══██╔══╝██╔══██╗██╔═══██╗     ██║██╔══██╗████╗  ██║██╔════╝██║ ██╔╝██║
             ██║   ██████╔╝██║   ██║     ██║███████║██╔██╗ ██║███████╗█████╔╝ ██║
             ██║   ██╔══██╗██║   ██║██   ██║██╔══██║██║╚██╗██║╚════██║██╔═██╗ ██║
             ██║   ██║  ██║╚██████╔╝╚█████╔╝██║  ██║██║ ╚████║███████║██║  ██╗██║
             ╚═╝   ╚═╝  ╚═╝ ╚═════╝  ╚════╝ ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝
                      </pre>
                      <div style="margin-top: -5px;">
                          User: <strong>Paweł Trojański</strong> (root)<br>
                          Role: Implementation Spec & .NET Dev
                      </div>`,a=!0;break;case"matrix":o="Wake up, Neo...",function e(){let t=document.getElementById("matrix-canvas");if(!t){console.error("Matrix canvas not found in HTML!"),alert("Error: <canvas id='matrix-canvas'> missing in HTML.");return}let s=t.getContext("2d");t.style.display="block",t.width=window.innerWidth,t.height=window.innerHeight;let n=t.width/16,i=[];for(let l=0;l<n;l++)i[l]=1;let r=()=>{s.fillStyle="rgba(0, 0, 0, 0.05)",s.fillRect(0,0,t.width,t.height),s.fillStyle="#0F0",s.font="16px monospace";for(let e=0;e<i.length;e++){let n="01".charAt(Math.floor(2*Math.random()));s.fillText(n,16*e,16*i[e]),16*i[e]>t.height&&Math.random()>.975&&(i[e]=0),i[e]++}},o=setInterval(r,33),a=()=>{clearInterval(o),t.style.display="none",document.getElementById("terminal-overlay").classList.remove("hidden-terminal"),t.removeEventListener("click",a)};t.addEventListener("click",a),window.addEventListener("resize",()=>{t.width=window.innerWidth,t.height=window.innerHeight})}(),s.classList.add("hidden-terminal");break;case"reboot":o="Rebooting system...",setTimeout(()=>{document.body.style.transition="opacity 1s",document.body.style.opacity="0",setTimeout(()=>location.reload(),1e3)},1e3);break;case"date":o=new Date().toString();break;case"cd":case"open":if(0===n.length)o="usage: cd [directory] or open [file]";else{let h=n[0].toLowerCase();h.includes("project")?(o="Navigating to Projects...",document.querySelector("#projects").scrollIntoView({behavior:"smooth"}),window.innerWidth<768&&s.classList.add("hidden-terminal")):"cv.pdf"===h?(o="Opening CV...",window.open("./assets/files/cv.pdf","_blank")):o=`cd: ${p(h)}: No such directory`}break;case"theme":if(0===n.length)o="usage: theme [light|dark]";else{let m=n[0].toLowerCase(),f=document.getElementById("theme-toggle");"light"===m?(document.body.classList.contains("light-mode")||f.click(),o="Theme set to LIGHT."):"dark"===m?(document.body.classList.contains("light-mode")&&f.click(),o="Theme set to DARK."):o=`theme: unknown argument '${p(m)}'`}break;case"sudo":o='<span style="color:red">guest is not in the sudoers file. This incident will be reported.</span>',a=!0;break;case"exit":s.classList.add("hidden-terminal");return;case"clear":for(;l.children.length>1;)l.removeChild(l.firstChild);return;case"":return;default:o=`Command not found: ${p(t)}. Type 'help' for options.`}let u=document.createElement("div");u.style.marginBottom="10px",u.style.color="#ccc",a?u.innerHTML=o:u.textContent=o,l.insertBefore(u,l.lastElementChild),l.scrollTop=l.scrollHeight})(i,n.slice(1),t),this.value=""}else"ArrowUp"===e.key?(e.preventDefault(),a>0&&(a--,this.value=o[a])):"ArrowDown"===e.key&&(e.preventDefault(),a<o.length-1?(a++,this.value=o[a]):(a=o.length,this.value=""))})}e(i),e(s),e(l),e(r),e(o),e(t),e(n),e(a),e(c),e(d),e(h),e(m),e(f)});